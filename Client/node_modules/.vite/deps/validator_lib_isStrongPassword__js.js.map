{
  "version": 3,
  "sources": ["../../validator/lib/util/merge.js", "../../validator/lib/util/assertString.js", "../../validator/lib/isStrongPassword.js"],
  "sourcesContent": ["\"use strict\";\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n  value: true\r\n});\r\nexports.default = merge;\r\nfunction merge() {\r\n  var obj = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\r\n  var defaults = arguments.length > 1 ? arguments[1] : undefined;\r\n  for (var key in defaults) {\r\n    if (typeof obj[key] === 'undefined') {\r\n      obj[key] = defaults[key];\r\n    }\r\n  }\r\n  return obj;\r\n}\r\nmodule.exports = exports.default;\r\nmodule.exports.default = exports.default;", "\"use strict\";\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n  value: true\r\n});\r\nexports.default = assertString;\r\nfunction assertString(input) {\r\n  if (input === undefined || input === null) throw new TypeError(\"Expected a string but received a \".concat(input));\r\n  if (input.constructor.name !== 'String') throw new TypeError(\"Expected a string but received a \".concat(input.constructor.name));\r\n}\r\nmodule.exports = exports.default;\r\nmodule.exports.default = exports.default;", "\"use strict\";\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n  value: true\r\n});\r\nexports.default = isStrongPassword;\r\nvar _merge = _interopRequireDefault(require(\"./util/merge\"));\r\nvar _assertString = _interopRequireDefault(require(\"./util/assertString\"));\r\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\r\nvar upperCaseRegex = /^[A-Z]$/;\r\nvar lowerCaseRegex = /^[a-z]$/;\r\nvar numberRegex = /^[0-9]$/;\r\nvar symbolRegex = /^[-#!$@Â£%^&*()_+|~=`{}\\[\\]:\";'<>?,.\\/\\\\ ]$/;\r\nvar defaultOptions = {\r\n  minLength: 8,\r\n  minLowercase: 1,\r\n  minUppercase: 1,\r\n  minNumbers: 1,\r\n  minSymbols: 1,\r\n  returnScore: false,\r\n  pointsPerUnique: 1,\r\n  pointsPerRepeat: 0.5,\r\n  pointsForContainingLower: 10,\r\n  pointsForContainingUpper: 10,\r\n  pointsForContainingNumber: 10,\r\n  pointsForContainingSymbol: 10\r\n};\r\n\r\n/* Counts number of occurrences of each char in a string\r\n * could be moved to util/ ?\r\n*/\r\nfunction countChars(str) {\r\n  var result = {};\r\n  Array.from(str).forEach(function (char) {\r\n    var curVal = result[char];\r\n    if (curVal) {\r\n      result[char] += 1;\r\n    } else {\r\n      result[char] = 1;\r\n    }\r\n  });\r\n  return result;\r\n}\r\n\r\n/* Return information about a password */\r\nfunction analyzePassword(password) {\r\n  var charMap = countChars(password);\r\n  var analysis = {\r\n    length: password.length,\r\n    uniqueChars: Object.keys(charMap).length,\r\n    uppercaseCount: 0,\r\n    lowercaseCount: 0,\r\n    numberCount: 0,\r\n    symbolCount: 0\r\n  };\r\n  Object.keys(charMap).forEach(function (char) {\r\n    /* istanbul ignore else */\r\n    if (upperCaseRegex.test(char)) {\r\n      analysis.uppercaseCount += charMap[char];\r\n    } else if (lowerCaseRegex.test(char)) {\r\n      analysis.lowercaseCount += charMap[char];\r\n    } else if (numberRegex.test(char)) {\r\n      analysis.numberCount += charMap[char];\r\n    } else if (symbolRegex.test(char)) {\r\n      analysis.symbolCount += charMap[char];\r\n    }\r\n  });\r\n  return analysis;\r\n}\r\nfunction scorePassword(analysis, scoringOptions) {\r\n  var points = 0;\r\n  points += analysis.uniqueChars * scoringOptions.pointsPerUnique;\r\n  points += (analysis.length - analysis.uniqueChars) * scoringOptions.pointsPerRepeat;\r\n  if (analysis.lowercaseCount > 0) {\r\n    points += scoringOptions.pointsForContainingLower;\r\n  }\r\n  if (analysis.uppercaseCount > 0) {\r\n    points += scoringOptions.pointsForContainingUpper;\r\n  }\r\n  if (analysis.numberCount > 0) {\r\n    points += scoringOptions.pointsForContainingNumber;\r\n  }\r\n  if (analysis.symbolCount > 0) {\r\n    points += scoringOptions.pointsForContainingSymbol;\r\n  }\r\n  return points;\r\n}\r\nfunction isStrongPassword(str) {\r\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\r\n  (0, _assertString.default)(str);\r\n  var analysis = analyzePassword(str);\r\n  options = (0, _merge.default)(options || {}, defaultOptions);\r\n  if (options.returnScore) {\r\n    return scorePassword(analysis, options);\r\n  }\r\n  return analysis.length >= options.minLength && analysis.lowercaseCount >= options.minLowercase && analysis.uppercaseCount >= options.minUppercase && analysis.numberCount >= options.minNumbers && analysis.symbolCount >= options.minSymbols;\r\n}\r\nmodule.exports = exports.default;\r\nmodule.exports.default = exports.default;"],
  "mappings": "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",
  "names": []
}
